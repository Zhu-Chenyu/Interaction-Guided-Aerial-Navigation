<?xml version="1.0"?>
<launch>
    <arg name="world_frame" default="optitrack" description="OptiTrack world frame"/>

    <!-- OptiTrack TF Publisher (from optitrack package) -->
    <node pkg="optitrack" exec="talker" name="optitrack_publisher" output="screen"/>

    <!-- Robot State Publisher (publishes URDF transforms) -->
    <node pkg="robot_state_publisher" exec="robot_state_publisher" name="robot_state_publisher" output="screen">
        <param name="robot_description" value="$(command 'xacro $(find-pkg-share drone_description)/urdf/X500V2.urdf.xacro')" type="str"/>
    </node>

    <!-- Static TF: base_link -> laser (adjust xyz to match LiDAR mount position) -->
    <node pkg="tf2_ros" exec="static_transform_publisher" name="base_to_laser_tf" output="screen"
          args="--x 0 --y 0 --z 0.05 --roll 0 --pitch 0 --yaw 0 --frame-id base_link --child-frame-id laser"/>

    <!-- Arena corner columns (purple markers) -->
    <node pkg="drone_description" exec="arena_markers_node" name="arena_markers" output="screen">
        <param name="frame_id" value="$(var world_frame)"/>
        <param name="column_width" value="0.1"/>
        <param name="column_height" value="2.92"/>
        <param name="x_back" value="-1.69"/>
        <param name="x_front" value="1.69"/>
        <param name="y_left" value="2.15"/>
        <param name="y_right" value="-3.27"/>
    </node>

    <!-- RViz (visualization) - no on_exit since we don't want RViz closing to kill everything -->
    <node pkg="rviz2" exec="rviz2" name="rviz2" output="screen"
          args="-d $(find-pkg-share drone_viz)/config/drone_viz.rviz"/>
</launch>
